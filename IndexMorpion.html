<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="MorpionCss.css">
    <title>Morpion</title>
</head>

<body>
    <main>
        <header>
            <div id="button">Reload Game</div>
         <!--<button #id="reload" onclick="window.location.reload()"> 
                Rejouer
            </button> -->
            <h1 class="h1">Morpion By Shadow</h1><hr width="5%" size="5" color="#ffffff">
        </header>
        <div id="container">
            <article id="article">
                <h2>Team Php</h2>
                <img src="PhpLogo.png" alt="Team Php" id="LogoPhp" class="php" />
                <div id="cross">
                    <h4>Score : <b id="player1">0</b></h4>
                </div>
            </article>
            <section id="section" class="allcase">
                <div class="carre sangoku border_right"></div>
                <div class="carre vegeta border_right"></div>
                <div class="carre sangoku border_right"></div>
                <div class="carre vegeta border_right"></div>
                <div class="carre sangoku border_right"></div>
                <div class="carre vegeta border_right"></div>
                <div class="carre sangoku border_right"></div>
                <div class="carre vegeta border_right"></div>
                <div class="carre sangoku border_right"></div>
            </section>
            <aside id="aside">
                <h2>Team Java</h2>
                <img src="JavaLogo.png" alt="Team Java" id="LogoJava" class="java" />
                <div id="circle">
                    <h4>Score : <b id="player2">0</b></h4>
                </div>
            </aside>
        </div>
        <footer>

        </footer>
    </main>
    <script>
                                                // j'initie toutes les variables dont j'aurais besoin

        function init(playerToBegin){
            game_over = false
            tour = 0
            current = playerToBegin
            symbole = ["x", "o"]
            cells = document.querySelectorAll(".carre")
            score_j1 = document.querySelector("#player1")
            score_j2 = document.querySelector("#player2")
            for(let cell of cells){
                cell.classList.remove("x", "o")
            }
        }
                                                // je stocke la liste des cases, le nombre de tour, et un tableau des symboles dans des variables

        let tour, game_over, symbole, cells, current, score_j1, score_j2
                                                              
        let winCase = {
            cond_one :[0,1,2],
            cond_two :[3,4,5],
            cond_three :[6,7,8],
            cond_four :[0,3,6],
            cond_five :[1,4,7],
            cond_six :[2,5,8],
            cond_seven :[0,4,8],
            cond_eight :[2,4,6]
        }

        init("x")

        for (let cell of cells) {                                     // Crée la variable cell en bouclant sur la varaiable cells
            cell.addEventListener("click", function(){                // Ajoute l'évenement click à cell
            
                if(cell.classList.length == 3 && !game_over){
                    cell.classList.add(current)
                    cell.innerHTML = current
                     
                }

                let arr = Array.from(cells)

                for(pattern in winCase){                                    // Patern parcours le Tableau
                    let pos = winCase[pattern]                              // je parcours un tableau de condition de victoires et je compare avec les cases remplies

                    if(arr[pos[0]].classList.contains(current) && arr[pos[1]].classList.contains(current) && arr[pos[2]].classList.contains(current)){
                        game_over = true                                    // je met un alerte pour déclarer la victoire et passer la variable de victoire à "true
                        if (current == "x"){
                            score_j1.innerHTML++
                            alert("Victoire pour la Team PHP")
                        }else{
                            score_j2.innerHTML++
                            alert("Victoire pour la Team JAVA")
                        }
                    }  
                }
                tour++                                                     // je rajoute une condition permettant au perdant de commencer
                current = (current == "x") ? "o" : "x"

                // je met en place une règle permettant de mettre une couleur au joueur qui doit jouer
                
                // si à la fin du tour 9 il n'y a toujours aucun vainqueur, on déclare le match nul

                if(tour > 8 && game_over == false){
                    alert("Match Nul")
                    game_over = true
                }                                                 
            })
            
        }

        let button = document.querySelector("#button")
        button.addEventListener("click", Event =>{
        init(current)
        })

    </script>
</body>

</html>